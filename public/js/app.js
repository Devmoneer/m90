const translations = {
    en: {
        login_title: "Login | Stock Exchange",
        username: "Username",
        password: "Password",
        login_button: "Login",
        forgot_password: "? Forgot password",
        create_account: "Create new account",
        signup_title: "Sign Up",
        full_name: "Full Name",
        email: "Email",
        confirm_password: "Confirm Password",
        signup_button: "Sign Up",
        already_have_account: "Already have an account? Login",
        error_empty_field: "Please fill in this field"
    },
    ar: {
        login_title: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
        username: "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
        password: "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
        login_button: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
        forgot_password: "Ù‡Ù„ Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ",
        create_account: "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯",
        signup_title: "ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯",
        full_name: "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„",
        email: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
        confirm_password: "ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
        signup_button: "ØªØ³Ø¬ÙŠÙ„",
        already_have_account: "Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
        error_empty_field: "ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„"
    },
    ckb: {
        login_title: "Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ• | Ø¨Û†Ø±Ø³Û•",
        username: "Ù†Ø§ÙˆÛŒ Ø¨Û•Ú©Ø§Ø±Ù‡ÛÙ†Û•Ø±",
        password: "ÙˆØ´Û•ÛŒ Ù†Ù‡ÛÙ†ÛŒ",
        login_button: "Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•",
        forgot_password: "ÙˆØ´Û•ÛŒ Ù†Ù‡ÛÙ†ÛŒØª Ù„Û•Ø¨ÛŒØ±Ú©Ø±Ø¯ÙˆÙˆÛ•ØŸ",
        create_account: "Ø­ÛŒØ³Ø§Ø¨ÛÚ©ÛŒ Ù†ÙˆÛ Ø¯Ø±ÙˆØ³Øª Ø¨Ú©Û•",
        signup_title: "ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†",
        full_name: "Ù†Ø§ÙˆÛŒ ØªÛ•ÙˆØ§Ùˆ",
        email: "Ø¦ÛŒÙ…Û•ÛŒÚµ",
        confirm_password: "Ø¯ÙˆÙˆØ¨Ø§Ø±Û•Ú©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ ÙˆØ´Û•ÛŒ Ù†Ù‡ÛÙ†ÛŒ",
        signup_button: "ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†",
        already_have_account: "Ù‡Û•Ú˜Ù…Ø§Ø±Øª Ù‡Û•ÛŒÛ•ØŸ Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•",
        error_empty_field: "ØªÚ©Ø§ÛŒÛ• Ø¦Û•Ù… Ø®Ø§Ù†Û• Ù¾Ú• Ø¨Ú©Û•Ø±Û•ÙˆÛ•"
    },
    badini: {
        login_title: "Ú†ÙˆÙˆÙ†Ø§Ú˜ÙˆÙˆØ± | Ø¨Û†Ø±Ø³Û•",
        username: "Ù†Ø§Ú¤Û Ø¨Ú©Ø§Ø±Ù‡ÛÙ†Û•Ø±ÛŒ",
        password: "Ù¾Û•ÛŒÚ¤Ø§ Ù†Ù‡ÛÙ†ÛŒ",
        login_button: "Ú†ÙˆÙˆÙ†Ø§Ú˜ÙˆÙˆØ±",
        forgot_password: "Ù¾Û•ÛŒÚ¤Ø§ Ù†Ù‡ÛÙ†ÛŒ ØªÛ• Ú˜Ø¨ÛŒØ±Ú©Ø±ÛŒÛ•ØŸ",
        create_account: "Ù‡Ú˜Ù…Ø§Ø±Û•Ú©Ø§ Ù†ÙˆÛŒ Ø¯Ø±ÙˆØ³Øª Ø¨Ú©Û•",
        signup_title: "ØªÛ†Ù…Ø§Ø±Ú©Ø±Ù†",
        full_name: "Ù†Ø§ÙˆÛŒ ØªÛ•ÙˆØ§Ùˆ",
        email: "Ø¦ÛŒÙ…Û•ÛŒÚµ",
        confirm_password: "Ø¯ÙˆÙˆØ¨Ø§Ø±Û•Ú©Ø±Ù†Ø§ Ù¾Û•ÛŒÚ¤Ø§ Ù†Ù‡ÛÙ†ÛŒ",
        signup_button: "ØªÛ†Ù…Ø§Ø±Ú©Ø±Ù†",
        already_have_account: "Ù‡Ú˜Ù…Ø§Ø± ØªÛ• Ù‡Û•ÛŒÛ•ØŸ Ú†ÙˆÙˆÙ†Ø§Ú˜ÙˆÙˆØ±",
        error_empty_field: "ØªÚ©Ø§ÛŒÛ• Ø¦Û•Ú¤ Ø®Ø§Ù†Û• Ù¾Ú• Ø¨Ú©Û•"
    }
};

document.addEventListener('DOMContentLoaded', function() {
    const savedLang = localStorage.getItem('preferredLanguage') || 
                     (navigator.language.startsWith('ar') ? 'ar' : 
                      navigator.language.startsWith('ckb') ? 'ckb' :
                      navigator.language.startsWith('badini') ? 'badini' : 'en');
    
    const languageSwitcher = document.querySelector('.language-switcher');
    
    if (languageSwitcher) {
        const toggleBtn = document.createElement('button');
        toggleBtn.className = 'lang-toggle-btn';
        toggleBtn.innerHTML = `
            <span class="logo-lang-btn">ğŸŒ</span>
        `;
        
        const buttonsContainer = document.createElement('div');
        buttonsContainer.className = 'lang-buttons-container';
        
        const existingButtons = Array.from(languageSwitcher.querySelectorAll('.lang-btn'));
        existingButtons.forEach(btn => {
            buttonsContainer.appendChild(btn);
        });
        
        languageSwitcher.innerHTML = '';
        languageSwitcher.appendChild(toggleBtn);
        languageSwitcher.appendChild(buttonsContainer);
        
        toggleBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            buttonsContainer.classList.toggle('show-lang-buttons');
        });
        
        document.addEventListener('click', function() {
            buttonsContainer.classList.remove('show-lang-buttons');
        });
        
        buttonsContainer.addEventListener('click', function(e) {
            e.stopPropagation();
        });
        
        buttonsContainer.querySelectorAll('.lang-btn').forEach(button => {
            button.addEventListener('click', function() {
                const lang = this.getAttribute('data-lang');
                changeLanguage(lang);
                buttonsContainer.classList.remove('show-lang-buttons');
            });
        });
    }
    
    changeLanguage(savedLang);
    
    document.querySelectorAll('form').forEach(form => {
        form.addEventListener('submit', function(e) {
            if (!validateForm(this)) {
                e.preventDefault();
            }
        });
        
        form.querySelectorAll('input[required]').forEach(input => {
            input.addEventListener('input', function() {
                if (this.value.trim()) {
                    hideError(this);
                }
            });
        });
    });
});

function changeLanguage(lang) {
    document.documentElement.lang = lang;
    document.documentElement.dir = lang === 'ar' || lang === 'ckb' || lang === 'badini' ? 'rtl' : 'ltr';
    
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[lang] && translations[lang][key]) {
            element.textContent = translations[lang][key];
        }
    });
    
    localStorage.setItem('preferredLanguage', lang);
}

function validateForm(form) {
    let isValid = true;
    const inputs = form.querySelectorAll('input[required]');
    
    inputs.forEach(input => {
        if (!input.value.trim()) {
            isValid = false;
            showError(input);
        } else {
            hideError(input);
        }
    });
    
    return isValid;
}

function showError(input) {
    let errorSpan = input.nextElementSibling;
    
    if (!errorSpan || !errorSpan.classList.contains('error-message')) {
        errorSpan = document.createElement('span');
        errorSpan.className = 'error-message';
        input.parentNode.insertBefore(errorSpan, input.nextSibling);
    }
    
    errorSpan.textContent = translations[document.documentElement.lang].error_empty_field;
    errorSpan.style.color = 'red';
    errorSpan.style.fontSize = '0.8rem';
    errorSpan.style.marginTop = '5px';
    errorSpan.style.display = 'block';
}

function hideError(input) {
    const errorSpan = input.nextElementSibling;
    if (errorSpan && errorSpan.classList.contains('error-message')) {
        errorSpan.remove();
    }
}

document.addEventListener('DOMContentLoaded', function() {
    const inputs = document.querySelectorAll('input, textarea, select');
    
    inputs.forEach(input => {
      input.addEventListener('focus', function() {
        const viewport = document.querySelector('meta[name="viewport"]');
        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
      });
  
      input.addEventListener('blur', function() {
        const viewport = document.querySelector('meta[name="viewport"]');
        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0');
      });
    });
  });

  